# è´¡çŒ®æŒ‡å—

## ğŸ¯ Issue

@mlz/admin é€šè¿‡ issue å¯¹`éœ€æ±‚`å’Œ`ç¼ºé™·`è¿›è¡Œç®¡ç†ï¼Œå®ƒä»¬çš„åˆ†åˆ«é‡Šä¹‰å¦‚ä¸‹ï¼š

### éœ€æ±‚

é€šè¿‡ issue.`åŠŸèƒ½æ·»åŠ ` å¯¹ **éœ€æ±‚** è¿›è¡Œåˆ›å»ºã€‚ä½ å¯ä»¥é€šè¿‡ github çš„ Issue é¢æ¿ç›´æ¥åˆ›å»ºéœ€æ±‚ã€‚è¯·**åŠ¡å¿…**æŒ‰ç…§ feature æ¨¡ç‰ˆå¡«å†™ã€‚

### ç¼ºé™·

é€šè¿‡ issue.`Bug åé¦ˆ` å¯¹ **ç¼ºé™·** è¿›è¡Œåˆ›å»ºå’Œç®¡ç†ã€‚åˆ›å»ºæ–¹æ³•åŒä¸Šï¼Œè¯·**åŠ¡å¿…**æŒ‰ç…§ bug æ¨¡ç‰ˆå¡«å†™ã€‚

## ğŸ¤ åä½œæ–¹å¼

@mlz/admin é‡‡ç”¨å¼€æºé¡¹ç›®çš„ç®¡ç†æ–¹å¼ï¼Œè¯·æ‚¨å°†é¡¹ç›® fork åˆ°**è‡ªèº«ç›®å½•**ä¸‹è¿›è¡Œ codingã€‚ä»£ç ç¼–å†™å®Œæˆä¹‹åï¼Œæäº¤åˆ° remote origin çš„å¯¹åº” branchï¼Œ**è€Œé upstream**ã€‚ä¹‹åä»**è‡ªèº«ç›®å½• remote origin**çš„ä»»æ„åˆ†æ”¯å‘èµ· pull request åˆ° juicecube/mlz-admin çš„å¯¹åº”**sprint** æˆ– **feature** åˆ†æ”¯ï¼Œåˆ›å»ºæ—¶çš„ç•Œé¢åº”å¦‚ä¸‹å›¾ ğŸ‘‡ï¼š

![create PR](https://raw.githubusercontent.com/milobluebell/imgs-repo/master/WX20200709-182741.png)

## ğŸ­ å·¥ä½œæµç®¡ç†

@mlz/admin è¦æ±‚é‡‡ç”¨ç¼–ç¨‹çŒ«ç°æœ‰çš„ git flow ç®¡ç†è§„èŒƒå¯¹ GIT.Flow è¿›è¡Œç®¡ç†ï¼š[ã€Šç¼–ç¨‹çŒ«å‰ç«¯ Git Flowã€‹](https://shimo.im/docs/aBAYV4XJdXfn8d3j)

> é™¤ä¸Šè¿°æ–‡æ¡£ä¸­å¥‘çº¦ä¹‹å¤–ï¼Œé¢å¤–è¦æ±‚ï¼š
>
> 1. ä¿è¯ CI ç­‰å„ç±» checkers å¿…é¡»é€šè¿‡ã€‚
> 2. å¿…é¡»é…æœ‰è¦†ç›–ç‡ä¸ä½äº **85%** çš„è‡ªæµ‹ç”¨ä¾‹ã€‚
> 3. éœ€è¦å¾—åˆ°è‡³å°‘å¦ä¸€ä½ç®¡ç†å‘˜çš„ review approval æ‰èƒ½åˆå¹¶ PRã€‚
> 4. éç¼–ç¨‹çŒ«å®˜æ–¹çš„äººå‘˜ç»´æŠ¤æ­¤åº“æ—¶åªé¡»éµå¾ª antd çš„è´¡çŒ®æŒ‡å—ï¼š [ã€Šant-design æ–°ç‰¹æ€§æäº¤è§„èŒƒã€‹](https://github.com/ant-design/ant-design/wiki/PR-%E8%A7%84%E8%8C%83#ant-design-%E6%96%B0%E7%89%B9%E6%80%A7%E6%8F%90%E4%BA%A4%E8%A7%84%E8%8C%83)

## ğŸ… éœ€æ±‚åˆ†é…å’Œé¢†å–

1. éœ€æ±‚åˆ›å»ºè¯·å‚ç…§æœ¬èŠ‚ç¬¬ä¸€éƒ¨åˆ†ã€‚
2. éœ€æ±‚åˆ†é…æœ¬ç€`è‡ªæ„¿é¢†å–ä¸ºåŸåˆ™`ã€‚
3. å½“æ— äººè®¤é¢†æ—¶ï¼Œ`åº”ç”±ç‹ç¦å‡¯æˆ–ç‹ç‰è¿›è¡Œåˆ†é…`ã€‚ä¼˜å…ˆåˆ†é…è‡³ç”±ç›¸å…³ä¸šåŠ¡çš„å¼€å‘äººå‘˜ã€‚

## ğŸ¤µ CSS åŸåˆ™

1. æˆ‘ä»¬æ²¿ç”¨ antd/dumiï¼Œä½¿ç”¨`.less`ä¸ºç»„ä»¶ç¼–å†™æ ·å¼ã€‚
2. æ‰©å±•çš„æ ·å¼ï¼Œcss å‘½åè§„èŒƒæŒ‰ç…§`BEMå‘½åè§„èŒƒ`è¿›è¡Œã€‚"è¯æ ¹"é»˜è®¤ä¸º**admini**
   > - `è§„èŒƒ`å¯å‚ç…§ï¼š[è…¾è®¯ CSS BEM ä¹¦å†™è§„èŒƒ](https://github.com/Tencent/tmt-workflow/wiki/%E2%92%9B-%5B%E8%A7%84%E8%8C%83%5D--CSS-BEM-%E4%B9%A6%E5%86%99%E8%A7%84%E8%8C%83)
   >
   > - `ä»£ç `å¯å‚ç…§**CommonTable**ç»„ä»¶ä¸­çš„ä»£ç 

## âš›ï¸ ç»„ä»¶è®¾è®¡åŸåˆ™

1. å°½é‡å‡å°‘ä¸€ä¸ªåŠŸèƒ½æ‰€éœ€è¦çš„æ–°å¢çš„ apiã€‚
2. ä¸¥ç¦è¦†ç›– antd åŸç”Ÿ apiï¼Œæ‰©å±•ä¹Ÿé¡»è°¨æ…ã€‚
3. å®ç°ä¸€ä¸ªåŠŸèƒ½æ—¶ï¼Œå°½é‡ä½¿æ•°æ®å†…èšï¼Œç‹¬è‡ªå½¢æˆé—­ç¯ã€‚å¯ä»¥ä½¿ç”¨ä¸€ä¸ª api+æ•°æ®å®ç°çš„ï¼Œä¸è¦åˆ†æˆå¤šä¸ªã€‚
4. Type ç±»å‹å®šä¹‰å°½é‡å’Œä¸šåŠ¡ä»£ç åˆ†å¼€ï¼Œä¸è¦æ”¾åœ¨åŒä¸€ä¸ªæ–‡ä»¶ï¼Œå³ä½¿ Types å¾ˆå°‘ã€‚
5. api å‘½åå°½é‡ä½¿ç”¨æœ€è´´åˆçš„è‹±æ–‡å•è¯ï¼Œä¸”å°½é‡ç®€çŸ­ã€‚é™ä½ä½¿ç”¨è€…è®¤çŸ¥å’Œè®°å¿†æˆæœ¬ã€‚

## ğŸ ç¦å¿Œ (IMPORTANT é‡è¦)

1. å¤§é‡ä½¿ç”¨`any`æˆ–è€…å¸¦æœ‰æ¶æ„ any
2. `å‘½å`ä¸ç¬¦åˆç¼–ç¨‹çŒ«å‰ç«¯å¼€å‘è§„èŒƒ(åŒ…æ‹¬ä½†ä¸é™äº`æ–‡ä»¶å‘½å`å’Œ`å˜é‡å‘½å`)ã€‚
3. æ–‡æ¡£çš„ Demo ç¤ºä¾‹ï¼Œå¿…é¡»ä½¿ç”¨ `Class Component` è¿›è¡Œå±•ç¤ºï¼Œä¸å¾—ä½¿ç”¨ FC ç»„ä»¶ã€‚
4. æºå¸¦å«æœ‰`æ•æ„Ÿæˆ–ç¼–ç¨‹çŒ«ä¸šåŠ¡ä¿¡æ¯`çš„ä»£ç è¿›è¡Œ commitã€‚
5. (TODO)

## ğŸ”¬ æµ‹è¯• (IMPORTANT é‡è¦)

1. æµ‹è¯•è¦†ç›–ç‡ï¼Œä¸ä½äº 85%ã€‚
2. æäº¤ PR å‰ï¼Œé¡»ä¿è¯ npm run test å¯ä»¥æ­£å¸¸é€šè¿‡ï¼Œå¹¶ä¸”é¢„è®¾çš„ checkers å¯¹åº”é’©å­æ‰§è¡Œé€šè¿‡ã€‚

## ğŸ“– æ–‡æ¡£ (IMPORTANT é‡è¦)

1. è¦æ±‚å¯¹ç»„ä»¶æ‰©å±•å‡ºæ¥çš„ api æœ‰æ˜ç¡®çš„å±•ç¤ºè¯´æ˜å’Œè¯¦å°½ä½¿ç”¨æ–¹æ³•ã€‚
2. æ¯ä¸ªç»„ä»¶ä¸‹çš„ APIs èŠ‚ï¼Œåªè¦æ±‚å†™å¤šå‡ºäº antd çš„ï¼ŒåŸç”Ÿçš„ä¸ç”¨å¤åˆ¶ä¸€éï¼ŒåŸç”Ÿ api å°½é‡å¼•å¯¼ç”¨æˆ·å»çœ‹ antd çš„æ–‡æ¡£ã€‚

## ğŸ˜Š å¼€å‘æœ€ä½³å®è·µ

#### 1. æƒ…å†µ 1âƒ£ï¸ï¼šæ²¡æœ‰å®é™…çš„ä¸šåŠ¡éœ€æ±‚ã€‚ åˆ™`ç›´æ¥é¡¹ç›®å†…å¼€å‘`ğŸ‘‡

> è¿™ç§æƒ…å†µä¸€èˆ¬æŒ‡ï¼Œå•çº¯åœ°å®Œæˆ@mlz/admin çš„å·²æœ‰ issue.Featureï¼Œé‚£ä¹ˆç›´æ¥è¿è¡Œ`npm start`åœ¨ demo é¡µè¿›è¡Œå¼€å‘å³å¯

#### 2. æƒ…å†µ 2âƒ£ï¸ï¼šç¼–å†™ä¸šåŠ¡éœ€æ±‚ä¸­çš„åå°ç³»ç»Ÿçš„ç»„ä»¶ã€‚ åˆ™`é€šè¿‡npm linkå¼€å‘` ğŸ‘‡

> ä¸ºé¡¹ç›®`projA`å¼€å‘å¤ç”¨ç»„ä»¶ã€‚
>
> 1.  å…ˆåœ¨é¡¹ç›®ä¸­å®‰è£… mytilsï¼ˆå› ä¸º@mlz/admin å¹³è¡Œä¾èµ– mytilsï¼‰

```shell
$ npm install mytils
```

> 2.  è¿›å…¥@mlz/admin é¡¹ç›®ï¼Œå¼€å§‹ç¼–å†™ç»„ä»¶ä»£ç ã€‚å®Œæˆåï¼Œè¿è¡Œ

```shell
$ npm dist
$
$ npm link
```

> 3.  è¿›å…¥`projA`é¡¹ç›®ï¼Œè¿è¡Œ

```shell
$ npm link @mlz/admin
```

ç„¶åå¼•ç”¨@mlz/adminï¼ŒæŸ¥çœ‹ç¼–ç ç»“æœï¼š

```jsx
import { Button } from '@mlz/admin'; // cjså¼•ç”¨
//or
import Button from '@mlz/admin/es/Button/Button'; // esmæŒ‰éœ€å¼•ç”¨
```

ä¹‹åä½ ç›´æ¥ä¿®æ”¹@mlz/admin ä¸­çš„ä»£ç ï¼Œå¹¶ä¸”é‡æ–°æ‰§è¡Œ distï¼ˆä¸å»ºè®®ç›´æ¥å¼•ç”¨ srcï¼‰ï¼Œåœ¨ projA åˆ·æ–°å°±å¯ä»¥å®æ—¶çœ‹åˆ°å˜åŒ–ã€‚

> ç”±äºæˆ‘ä»¬æ¨èä½¿ç”¨ FC ç»„ä»¶ï¼Œæ‰€ä»¥å¯èƒ½ä¼šå‡ºç°å¦‚ä¸‹æŠ¥é”™ï¼š
>
> **Error: Invalid hook call. Hooks can only be called inside of the body of a function component**
>
> å¯èƒ½æ˜¯å› ä¸ºï¼š
>
> 1.  https://github.com/facebook/react/issues/13991
> 2.  https://reactjs.org/warnings/invalid-hook-call-warning.html#duplicate-react
> 3.  https://github.com/webpack/webpack/issues/8607#issuecomment-453068938
> 4.  å¦‚æœä»¥ä¸Šä¸‰ç§æƒ…å†µæ— æ³•è§£å†³ï¼Œåˆ™å¯èƒ½æ˜¯ç”±äº React è‡ªèº« bug å¯¼è‡´ã€‚å‚è€ƒ ğŸ‘‰https://github.com/facebook/react/issues/13991#issuecomment-435135293 ï¼Œé‚£ä¹ˆå°±å¿…é¡»ä½¿ç”¨ç¬¬ä¸‰ç§å¼€å‘æ–¹å¼ ğŸ‘‡

#### 3. æƒ…å†µ 3âƒ£ï¸ï¼šä½¿ç”¨ npm link å¼€å‘ç»„ä»¶æ—¶é‡åˆ°å›°éš¾ã€‚ åˆ™`é€šè¿‡npm dist + packå¼€å‘` ğŸ‘‡

å³å…ˆæŒ‰ç…§`æƒ…å†µ1âƒ£ï¸`è¿›è¡Œå¼€å‘ï¼Œæ¯æ¬¡è°ƒè¯•æ—¶ï¼Œéœ€è¦å…ˆè¿è¡Œ`npm run dist`æ‰“åŒ…å‡ºè‡³å°‘ esm/lib ä¸¤ç§æ¨¡å¼ pkgï¼Œç„¶åå†è¿è¡Œ`npm pack`ï¼Œè¿™ä¸ªæ—¶å€™é¡¹ç›®æ ¹ç›®å½•ä¼šå¤šå¤„ä¸€ä¸ª `.tgz` æ–‡ä»¶ï¼Œå°†è¯¥æ–‡ä»¶æ‹–æ‹½åˆ° projAï¼Œç„¶ååœ¨ projA çš„ç»ˆç«¯å®‰è£…å®ƒï¼Œæ¯”å¦‚ï¼š

```shell
$ npm install ./mlz-admin-0.0.9.tgz
```

ä¹‹åä½¿ç”¨å³å¯ï¼š

```jsx
import { Button } from '@mlz/admin'; // cjså¼•ç”¨
//or
import Button from '@mlz/admin/es/Button/Button'; // esmæŒ‰éœ€å¼•ç”¨
```
