# è´¡çŒ®æŒ‡å—

"è´¡çŒ®æŒ‡å—"ä½œä¸ºå¼€å‘æœ¬åº“çš„ç¨‹åºç¼–ç å’Œå·¥ä½œå¼€å±•çš„å¥‘çº¦ï¼Œè¦æ±‚ç¼–ç¨‹çŒ«å®˜æ–¹äººå‘˜å¿…é¡»éµå®ˆå…¨éƒ¨ç»†åˆ™ï¼Œå¤–éƒ¨äººå‘˜åº”å½“éµå®ˆå…¶ä¸­éƒ¨åˆ†ç»†åˆ™ã€‚

## ğŸ¯ Issue

@mlz/admin é€šè¿‡ issue å¯¹`éœ€æ±‚`å’Œ`ç¼ºé™·`è¿›è¡Œç®¡ç†ï¼Œå®ƒä»¬çš„åˆ†åˆ«é‡Šä¹‰å¦‚ä¸‹ï¼š

### éœ€æ±‚

é€šè¿‡ issue.`åŠŸèƒ½æ·»åŠ ` å¯¹ **éœ€æ±‚** è¿›è¡Œåˆ›å»ºã€‚ä½ å¯ä»¥é€šè¿‡ github çš„ Issue é¢æ¿ç›´æ¥åˆ›å»ºéœ€æ±‚ã€‚è¯·**åŠ¡å¿…**æŒ‰ç…§ feature æ¨¡ç‰ˆå¡«å†™ã€‚

### ç¼ºé™·

é€šè¿‡ issue.`Bug åé¦ˆ` å¯¹ **ç¼ºé™·** è¿›è¡Œåˆ›å»ºå’Œç®¡ç†ã€‚åˆ›å»ºæ–¹æ³•åŒä¸Šï¼Œè¯·**åŠ¡å¿…**æŒ‰ç…§ bug æ¨¡ç‰ˆå¡«å†™ã€‚

## ğŸ¤ åä½œæ–¹å¼

@mlz/admin é‡‡ç”¨å¼€æºé¡¹ç›®çš„ç®¡ç†æ–¹å¼ï¼Œè¯·æ‚¨å°†é¡¹ç›® fork åˆ°**è‡ªèº«ç›®å½•**ä¸‹è¿›è¡Œ codingã€‚ä»£ç ç¼–å†™å®Œæˆä¹‹åï¼Œæäº¤åˆ° remote origin çš„å¯¹åº” branchï¼Œ**è€Œé upstream**ã€‚**åœ¨ç¡®å®šè‡ªèº«ä»£ç æ— è¯¯ï¼Œä¸” checkers å…¨éƒ¨è¿è¡ŒæˆåŠŸå**ï¼Œä»**è‡ªèº«ç›®å½• remote origin**å‘èµ· pull request åˆ° juicecube/mlz-admin çš„å¯¹åº”**sprint** æˆ– **feature** åˆ†æ”¯ã€‚æ•´ä¸ªæµç¨‹å¦‚ä¸‹ ğŸ‘‡ï¼š

![create PR](https://raw.githubusercontent.com/milobluebell/imgs-repo/master/WX20201105-1130223.png)

> é™¤ä¸Šè¿°æ–‡æ¡£ä¸­å¥‘çº¦ä¹‹å¤–ï¼Œé¢å¤–è¦æ±‚ï¼š
>
> 1. æ‰€æœ‰ä»£ç å¿…é¡»é€šè¿‡éƒ¨ç½²åœ¨å¯¹åº”åˆ†æ”¯ push è§¦å‘çš„ checkers æ£€æµ‹æˆåŠŸåï¼Œå†å‘èµ·å‘ Pull Requestã€‚ä»¥å‡å°‘ä¸å¿…è¦çš„ PR å’Œ code reviewã€‚
> 2. **PR è¡¨å•è¯·å¦‚å®è®¤çœŸå¡«å†™**ã€‚
> 3. éç¼–ç¨‹çŒ«å®˜æ–¹çš„äººå‘˜ç»´æŠ¤æ­¤åº“æ—¶åªé¡»éµå¾ª antd çš„è´¡çŒ®æŒ‡å—ï¼š [ã€Šant-design æ–°ç‰¹æ€§æäº¤è§„èŒƒã€‹](https://github.com/ant-design/ant-design/wiki/PR-%E8%A7%84%E8%8C%83#ant-design-%E6%96%B0%E7%89%B9%E6%80%A7%E6%8F%90%E4%BA%A4%E8%A7%84%E8%8C%83)

## ğŸ¢ ä¾èµ–ç®¡ç†

ä¸ºäº†é¿å…ä¸€äº›æ„å¤–çš„ bug å½±å“ä½ çš„å¼€å‘è¿›åº¦å’Œä½“éªŒï¼Œè¯·å°½é‡ä½¿ç”¨`npm`è¿›è¡Œä¾èµ–ç®¡ç†[Dumi Issue#117 bug: åŒ…å†²çª](https://github.com/umijs/dumi/issues/117)

## ğŸ­ workflow ç®¡ç†

#### git flow @mlz/admin è¦æ±‚é‡‡ç”¨ç¼–ç¨‹çŒ«ç°æœ‰çš„ git flow ç®¡ç†è§„èŒƒå¯¹ GIT.Flow è¿›è¡Œç®¡ç†ï¼š[ã€Šç¼–ç¨‹çŒ«å‰ç«¯ Git Flowã€‹](https://shimo.im/docs/aBAYV4XJdXfn8d3j)

###

## ğŸ… éœ€æ±‚åˆ†é…å’Œé¢†å–

1. éœ€æ±‚åˆ›å»ºè¯·å‚ç…§æœ¬èŠ‚ç¬¬ä¸€éƒ¨åˆ†ã€‚
2. éœ€æ±‚åˆ†é…æœ¬ç€`è‡ªæ„¿é¢†å–ä¸ºåŸåˆ™`ï¼Œå»ºè®®`éœ€æ±‚äº¤æ¢è§£å†³ï¼ŒååŠ©ä»–äººå®Œæˆéœ€æ±‚`ã€‚
3. å½“é•¿æ—¶é—´æ— äººè®¤é¢†æ—¶ï¼Œ`åº”ç”± @Fukiii æˆ– @webyom é…Œæƒ…åˆ†é…`ã€‚ä¼˜å…ˆç¨‹åº¦ä¸Šï¼Œä¼˜å…ˆåˆ†é…è‡³ç›¸å…³ä¸šåŠ¡çš„å¼€å‘äººå‘˜ã€‚

## ğŸ“ æ–‡ä»¶å‘½åè§„èŒƒ

ä¸ºèƒ½å¤Ÿä½¿ç”¨`babel-import-plugin`æŒ‰éœ€å¼•å…¥ç»„ä»¶ï¼Œæˆ‘ä»¬è§„å®šï¼š

1. ç»„ä»¶å‘½åå¿…é¡»ä½¿ç”¨**å°å†™å­—æ¯**ï¼Œæ¯”å¦‚ Icon ç»„ä»¶ï¼Œåº”è¯¥å®šä½åœ¨ **src/icon/index.tsx**ä¸­ï¼Œè€Œä¸æ˜¯ src/Icon/xxx.tsx æˆ–å…¶ä»–ç¥é©¬ã€‚
2. åˆ†è¯å‘½åä»¥**é“¾æ¥ç¬¦**éš”å¼€ï¼ˆåŸåˆ™ä¸Šæ˜¯ï¼Œä½†ä¸ªåˆ«ç»„ä»¶æœ‰æ„å¤–ï¼Œæ¯”å¦‚ popconfirmï¼Œå®ƒåœ¨ antd æ²¡æœ‰è¢«é“¾æ¥ç¬¦å‘½åï¼‰ï¼Œæ—¢ä¸æ˜¯å¤§å°é©¼å³°ï¼Œæ›´ä¸æ˜¯ snake å‘½åã€‚æ¯”å¦‚ DatePicker ç»„ä»¶ï¼Œåº”è¯¥å®šä½åœ¨ src/**date-picker**/index.tsx è€Œä¸æ˜¯ src/datePicker/index.tsxã€‚
3. ç»„ä»¶ä½¿ç”¨ default export ï¼Œä¸”ç”± **index.tsx** æ‰¿æ‹…ã€‚æ¯”å¦‚ Button ç»„ä»¶ï¼Œåº”è¯¥å®šä½åœ¨ src/button/**index.tsx**è€Œä¸æ˜¯ src/button/button.tsxã€‚

## ğŸ¤µ CSS åŸåˆ™

1. æˆ‘ä»¬æ²¿ç”¨ antd çš„æŠ€æœ¯æ–¹æ¡ˆï¼Œç”¨ä¸”åªç”¨`.less`ä¸ºç»„ä»¶ç¼–å†™åŠ¨/é™æ€æ ·å¼ã€‚
2. æ‰©å±•çš„æ ·å¼ï¼Œcss å‘½åè§„èŒƒæŒ‰ç…§`BEMå‘½åè§„èŒƒ`è¿›è¡Œã€‚"è¯æ ¹"é»˜è®¤ä¸º**admini**
   > - `è§„èŒƒ`å¯å‚ç…§ï¼š[è…¾è®¯ CSS BEM ä¹¦å†™è§„èŒƒ](https://github.com/Tencent/tmt-workflow/wiki/%E2%92%9B-%5B%E8%A7%84%E8%8C%83%5D--CSS-BEM-%E4%B9%A6%E5%86%99%E8%A7%84%E8%8C%83)
   >
   > - `ä»£ç `å¯å‚ç…§**CommonTable**ç»„ä»¶ä¸­çš„ä»£ç 

## âš›ï¸ ç»„ä»¶å’Œ API è®¾è®¡åŸåˆ™

1. å°½é‡å‡å°‘ä¸€ä¸ªåŠŸèƒ½æ‰€éœ€è¦çš„æ–°å¢çš„ apiï¼Œå°½å¯èƒ½çš„ä½è€¦åˆé«˜å†…èšã€‚
2. **ä¸¥ç¦ä¿®æ”¹å’Œè¦†ç›– antd çš„ api å’Œæ ·å¼å¤–çš„é…å¥—åŠŸèƒ½ï¼Œå…è®¸æ‰©å±•ï¼Œä½†å¿…é¡»ååˆ†è°¨æ…**ã€‚
3. type ç±»å‹å®šä¹‰å°½é‡å’Œä¸šåŠ¡ä»£ç åˆ†å¼€ï¼Œä¸è¦æ”¾åœ¨åŒä¸€ä¸ªæ–‡ä»¶ï¼Œå³ä½¿ types å¾ˆå°‘ã€‚
4. api å‘½åå°½é‡ä½¿ç”¨æœ€è´´åˆçš„è‹±æ–‡å•è¯ã€ä¸ antd api å·®è·å°½å¯èƒ½å°ï¼Œä¸”å°½é‡ç®€çŸ­ï¼ˆä¸¾ä¾‹é‡Šä¹‰ï¼šæ¯”å¦‚ antd.Table ä½¿ç”¨ render æ¥æ¸²æŸ“ columnï¼Œæˆ‘ä»¬å°è£…å¯¹åº”æœç´¢æ çš„è‡ªå®šä¹‰æ¸²æŸ“ç»„ä»¶ï¼Œå°±ä¸åº”è¯¥å« searchComponentï¼Œè€Œæ˜¯ searchRenderï¼Œç”¨æˆ·åªéœ€è¾¨åˆ«æ˜¯å¦å¸¦æœ‰ searchï¼‰ï¼Œé™ä½ä½¿ç”¨è€…è®¤çŸ¥å’Œè®°å¿†æˆæœ¬ã€‚
5. è€Œå†…éƒ¨å‡½æ•°æˆ–å˜é‡ï¼Œåº”è¯¥åœ¨æ»¡è¶³è´´åˆè¯­ä¹‰çš„æƒ…å†µä¸‹ï¼Œå°½é‡å¢åŠ é•¿åº¦ä»¥ç²¾ç¡®åœ°è¡¨è¾¾å…¶å«ä¹‰ï¼ˆä¸¾ä¾‹é‡Šä¹‰ï¼šæ¯”å¦‚ keyTransformer å½“ä¸€ä¸ªé¡µé¢å‡ºç° key å…³é”®è¯è¶…è¿‡ 2 æ¬¡æˆ– key çš„åˆ«åæ—¶å°±æéš¾ reviewï¼Œæ­£ç¡®å«æ³•åº”å¦‚ indexNamedKeyByBackendTransformer æˆ– keyUniquedInTableTransformerï¼‰ã€‚
6. æ–¹æ³•ã€å±æ€§æˆ–å‡½æ•°å‚æ•°è¶…è¿‡ 3 ä¸ªåº”è¯¥æŠ˜å ä¸ºå¯¹è±¡ï¼Œè€Œä¸æ˜¯å‘åå †ç§¯ã€‚åŒç±»åŠŸèƒ½çš„ api ä¹Ÿåº”è¯¥æŠ˜å ä¸ºå¯¹è±¡è¿›è¡Œç»Ÿä¸€æ”¾ç½®ï¼Œè€Œä¸æ˜¯æ•£å¾—åˆ°å¤„éƒ½æ˜¯ï¼ˆä¸¾ä¾‹é‡Šä¹‰ï¼šåˆ†é¡µå™¨éœ€è¦çš„å‚æ•°ï¼Œä¸åº”è¯¥åˆ†ä¸º 4 ä¸ª prop ä¼ å…¥æŸç»„ä»¶ï¼Œè€Œæ˜¯åº”è¯¥ä»¥ pagination: {current, pageSize, ...} çš„æ–¹å¼ç»Ÿä¸€æ”¾ç½®ï¼‰

## ğŸ ç¦å¿Œ

1. æ¶æ„ä½¿ç”¨ `any`ã€‚
2. `å‘½å`ä¸ç¬¦åˆç¼–ç¨‹çŒ«å‰ç«¯å¼€å‘è§„èŒƒ(è§„èŒƒåŒ…æ‹¬ä½†ä¸é™äºä¸Šæ–‡æåˆ°çš„`åˆ†æ”¯è§„èŒƒ`ã€`æ–‡ä»¶å‘½å`å’Œ`å˜é‡å‘½å`è§„èŒƒ)ã€‚
3. æºå¸¦`å¤–ç½‘å¯è§¦è¾¾`çš„`æ•æ„Ÿä¿¡æ¯`æˆ–`ç¼–ç¨‹çŒ«ä¸šåŠ¡ä¿¡æ¯`çš„ä»£ç ã€‚
4. ä½¿ç”¨ä¸å®‰å…¨çš„è„šæœ¬ä»£ç ã€‚
5. ä¸¥ç¦ä¿®æ”¹å¼€æºåè®®ã€‚

## ğŸ”¬ æµ‹è¯•

1. æµ‹è¯•è¦†ç›–ç‡ï¼ŒåŸåˆ™ä¸Šä¸ä½äº 85%ï¼Œå…¶ä»–é™åˆ¶è¯·å‚ç…§ package.json æ–‡ä»¶ã€‚
2. æäº¤ PR å‰ï¼Œé¡»ä¿è¯ npm run test å¯ä»¥æ­£å¸¸é€šè¿‡ï¼Œå¹¶ä¸”é¢„è®¾çš„å…¶å®ƒ checkers é’©å­æ‰§è¡Œé€šè¿‡ã€‚

## ğŸ“– æ–‡æ¡£

1. è¦æ±‚å¯¹ç»„ä»¶æ‰©å±•å‡ºæ¥çš„ api æœ‰æ˜ç¡®çš„å±•ç¤ºè¯´æ˜å’Œè¯¦å°½ä½¿ç”¨æ–¹æ³•ã€‚
2. æ¯ä¸ªç»„ä»¶ä¸‹çš„ APIs èŠ‚ï¼Œåªè¦æ±‚å†™å¤šå‡ºäº antd çš„ï¼ŒåŸç”Ÿçš„ä¸ç”¨å¤åˆ¶ä¸€éï¼ŒåŸç”Ÿ api å°½é‡å¼•å¯¼ç”¨æˆ·å»çœ‹ antd çš„æ–‡æ¡£ã€‚

---

## ğŸ˜Š å¼€å‘æœ€ä½³å®è·µ

#### 1. æƒ…å†µ 1âƒ£ï¸ï¼šæ²¡æœ‰å®é™…çš„ä¸šåŠ¡éœ€æ±‚ã€‚ åˆ™`ç›´æ¥é¡¹ç›®å†…å¼€å‘`ğŸ‘‡

> è¿™ç§æƒ…å†µä¸€èˆ¬æŒ‡ï¼Œå•çº¯åœ°å®Œæˆ@mlz/admin çš„å·²æœ‰ issue.Featureï¼Œé‚£ä¹ˆç›´æ¥è¿è¡Œ`npm start`åœ¨ demo é¡µè¿›è¡Œå¼€å‘å³å¯

#### 2. æƒ…å†µ 2âƒ£ï¸ï¼šç¼–å†™ä¸šåŠ¡éœ€æ±‚ä¸­çš„åå°ç³»ç»Ÿçš„ç»„ä»¶ã€‚ åˆ™`é€šè¿‡npm linkå¼€å‘` ğŸ‘‡

> ä¸ºé¡¹ç›®`projA`å¼€å‘å¤ç”¨ç»„ä»¶ã€‚
>
> 1.  å…ˆåœ¨é¡¹ç›®ä¸­å®‰è£… mytilsï¼ˆå› ä¸º@mlz/admin å¹³è¡Œä¾èµ– mytilsï¼‰

```shell
$ npm install mytils
```

> 2.  è¿›å…¥@mlz/admin é¡¹ç›®ï¼Œå¼€å§‹ç¼–å†™ç»„ä»¶ä»£ç ã€‚å®Œæˆåï¼Œè¿è¡Œ

```shell
$ npm dist
$
$ npm link
```

> 3.  è¿›å…¥`projA`é¡¹ç›®ï¼Œè¿è¡Œ

```shell
$ npm link @mlz/admin
```

ç„¶åå¼•ç”¨@mlz/adminï¼ŒæŸ¥çœ‹ç¼–ç ç»“æœï¼š

```jsx
import { Button } from '@mlz/admin'; // cjså¼•ç”¨
//or
import Button from '@mlz/admin/es/button'; // esmæŒ‰éœ€å¼•ç”¨
```

ä¹‹åä½ ç›´æ¥ä¿®æ”¹@mlz/admin ä¸­çš„ä»£ç ï¼Œå¹¶ä¸”é‡æ–°æ‰§è¡Œ distï¼ˆä¸å»ºè®®ç›´æ¥å¼•ç”¨ srcï¼‰ï¼Œåœ¨ projA åˆ·æ–°å°±å¯ä»¥å®æ—¶çœ‹åˆ°å˜åŒ–ã€‚

> ç”±äºæˆ‘ä»¬æ¨èä½¿ç”¨ FC ç»„ä»¶ï¼Œæ‰€ä»¥å¯èƒ½ä¼šå‡ºç°å¦‚ä¸‹æŠ¥é”™ï¼š
>
> **Error: Invalid hook call. Hooks can only be called inside of the body of a function component**
>
> å¯èƒ½æ˜¯å› ä¸ºï¼š
>
> 1.  https://reactjs.org/warnings/invalid-hook-call-warning.html#duplicate-react
>
> æˆ–è€…
>
> 2.  https://github.com/facebook/react/issues/13991
> 3.  https://github.com/webpack/webpack/issues/8607#issuecomment-453068938
>
>     å¦‚æœä»¥ä¸Šä¸‰ç§æƒ…å†µæ— æ³•è§£å†³ï¼Œåˆ™å¯èƒ½æ˜¯ç”±äº React è‡ªèº« bug å¯¼è‡´ã€‚å‚è€ƒ ğŸ‘‰https://github.com/facebook/react/issues/13991#issuecomment-435135293 ï¼Œé‚£ä¹ˆå°±å¿…é¡»ä½¿ç”¨ç¬¬ä¸‰ç§å¼€å‘æ–¹å¼ ğŸ‘‡

#### 3. æƒ…å†µ 3âƒ£ï¸ï¼šä½¿ç”¨ npm link å¼€å‘ç»„ä»¶æ—¶é‡åˆ°å›°éš¾ã€‚ åˆ™`é€šè¿‡npm dist + packå¼€å‘`

å³å…ˆæŒ‰ç…§`æƒ…å†µ1âƒ£ï¸`è¿›è¡Œå¼€å‘ï¼Œæ¯æ¬¡è°ƒè¯•æ—¶ï¼Œéœ€è¦å…ˆè¿è¡Œ`npm run dist`æ‰“åŒ…å‡ºè‡³å°‘ esm/lib ä¸¤ç§æ¨¡å¼ pkgï¼Œç„¶åå†è¿è¡Œ`npm pack`ï¼Œè¿™ä¸ªæ—¶å€™é¡¹ç›®æ ¹ç›®å½•ä¼šå¤šå¤„ä¸€ä¸ª `.tgz` æ–‡ä»¶ï¼Œå°†è¯¥æ–‡ä»¶æ‹–æ‹½åˆ° projAï¼Œç„¶ååœ¨ projA çš„ç»ˆç«¯å®‰è£…å®ƒï¼Œæ¯”å¦‚ï¼š

```shell
$ npm install ./mlz-admin-0.0.9.tgz
```

ä¹‹åä½¿ç”¨å³å¯ï¼š

```jsx
import { Button } from '@mlz/admin';

// or

import Button from '@mlz/admin/es/button';
```
